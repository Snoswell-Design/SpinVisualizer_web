"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Braket=t():e.Braket=t()}(this,(()=>(this.webpackChunk=this.webpackChunk||[]).push([[769],{906:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MakeSliderControl=t.TopSlider=t.PlaySlider=void 0;const s=i(689);class r extends s.Grid{constructor(e,t){super("play_slider"),this.playImg=e.assetLocation+"/images/play.svg",this.pauseImg=e.assetLocation+"/images/pause.svg",this.addColumnDefinition(30,!0),this.addColumnDefinition(1),this.verticalAlignment=s.Control.VERTICAL_ALIGNMENT_TOP,this.background="#99999999",this.width="100%",this.height="30px",this.playPause=s.Button.CreateImageOnlyButton("play/pause button",this.pauseImg),this.playPause.image.stretch=s.Image.STRETCH_UNIFORM,this.playPause.width="20px",this.playPause.height="20px",this.playPause.color="transparent",this.addControl(this.playPause,0,0),this.sliderContainer=new s.Rectangle,this.sliderContainer.width="100%",this.sliderContainer.height="100%",this.sliderContainer.thickness=0,this.addControl(this.sliderContainer,0,1),this.slider=new s.Slider("animation_slider"),this.slider.width="100%",this.slider.height="20px",this.slider.color="black",this.slider.minimum=0,this.slider.maximum=0,this.slider.step=t,this.tickContainer=new s.Grid,this.tickContainer.width="100%",this.tickContainer.height="100%",this.tickContainer.paddingLeftInPixels=this.slider.thumbWidthInPixels/2,this.tickContainer.paddingRightInPixels=this.slider.thumbWidthInPixels/2,this.tickContainer.background="#00000022",this.sliderContainer.addControl(this.tickContainer),this.sliderContainer.addControl(this.slider),this.currentTime=0,this.speed=1,this.paused=!1,this.suppressNextSliderUpdate=!1,this.listeners=new Array,e.scene.registerBeforeRender((()=>{if(!this.paused){this.currentTime+=e.scene.deltaTime*this.speed/1e3,this.currentTime>this.slider.maximum&&(this.currentTime=0),this.suppressNextSliderUpdate=!0,this.slider.value=this.currentTime;for(let e of this.listeners)e(this.currentTime)}})),this.slider.onValueChangedObservable.add((e=>{if(this.suppressNextSliderUpdate)this.suppressNextSliderUpdate=!1;else{this.currentTime=e,this.paused||(this.paused=!0,this.playPause.image.source=this.playImg);for(let e of this.listeners)e(this.currentTime)}})),this.playPause.onPointerClickObservable.add((()=>{this.paused?(this.paused=!1,this.playPause.image.source=this.pauseImg):(this.paused=!0,this.playPause.image.source=this.playImg)}))}get maximum(){return this.slider.maximum}set maximum(e){this.slider.maximum=e}updateTicks(e){this.tickContainer.clearControls();for(let e=this.tickContainer.columnCount-1;e>=0;e--)this.tickContainer.removeColumnDefinition(e);if(!(null==e||e.length<1)){e[0]>0&&e.unshift(0),e[e.length-1]<this.slider.maximum&&e.push(this.slider.maximum);for(let t=0;t<e.length-1;t++)if(this.tickContainer.addColumnDefinition(e[t+1]-e[t]),t%2==1){let e=new s.Rectangle;e.width="100%",e.height="100%",e.background="#55FF5566",e.thickness=0,this.tickContainer.addControl(e,0,t)}}}}t.PlaySlider=r,t.TopSlider=function(e,t,i,r,n){let a=new s.TextBlock(e+"_label");a.text=e,a.height="30px",a.color="black",a.textHorizontalAlignment=0,a.paddingLeftInPixels=5;let o=new s.Slider(e+"_slider");o.width="100%",o.height="20px",o.color="black",o.minimum=t,o.maximum=i,o.step=r,o.onValueChangedObservable.add(n);let l=new s.Grid(e+"_controls");return l.addColumnDefinition(150,!0),l.addColumnDefinition(1),l.verticalAlignment=s.Control.VERTICAL_ALIGNMENT_TOP,l.background="#99999999",l.width="100%",l.height="30px",l.addControl(a,0,0),l.addControl(o,0,1),[l,o]},t.MakeSliderControl=function(e){let t=new s.TextBlock(e+"_label");t.text=e,t.height="30px",t.color="black",t.textHorizontalAlignment=0;let i=new s.Slider(e+"_radius");i.width="100%",i.height="20px",i.color="black";let r=new s.StackPanel(e+"_controls");return r.width="100%",r.adaptHeightToChildren=!0,r.addControl(t),r.addControl(i),[r,i]}},545:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MakeControlGUI=t.AddCycleSlider=void 0;const s=i(689),r=i(906),n=i(839),a=i(906);function o(e){if(!(e.material instanceof n.BraketMaterial))throw new Error("AddCycleSlider only works on scenes with a BraketMaterial");return e.material}t.AddCycleSlider=function(e){let t=o(e);const i=new r.PlaySlider(e,.01);i.maximum=1,i.speed=1/t.period,t.period=0,t.addListener((()=>{let e=Math.abs(t.spin);if(0==t.spin)i.updateTicks([]);else{let t=new Array(e);for(let e=0;e<t.length;e++)t[e]=e/t.length;i.updateTicks(t)}}),!0),i.listeners.push((e=>{t.time=e*Math.PI*2})),e.gui.addControl(i)},t.MakeControlGUI=function(e){let t=o(e),i=new s.StackPanel("shader_panel");i.isVertical=!0,i.width="100%",i.setPaddingInPixels(5),i.adaptHeightToChildren=!0;let[r,n]=(0,a.MakeSliderControl)("Phase");n.minimum=0,n.maximum=1,e.scene.registerAfterRender((()=>{n.value=t.time/Math.PI/2%1})),n.onValueChangedObservable.add((e=>{t.time=e*Math.PI*2})),i.addControl(r);let[l,d]=(0,a.MakeSliderControl)("Cycle Time");return d.minimum=0,d.maximum=5,d.value=1,d.onValueChangedObservable.add((e=>{t.period=e})),i.addControl(l),i}},325:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,r)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||s(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(839),t),r(i(545),t)},839:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BraketMaterial=t.New=void 0;const s=i(809);t.New=function(e){return t=>{let i=new r(t);return i.parseBraKet(e),i}};class r extends s.CustomMaterial{constructor(e){super("BraKet_Material",e),this.stepSpeeds=new Float32Array(5),this.stepPhases=new Float32Array(5),this.stepRotations=new Float32Array(5),this.kernelWinds=new Float32Array(4),this.kernelPhases=new Float32Array(4),this._time=0,this.period=8,this.radius=10,this.power=1.5,this.center=1.3,this.spin=0,this.braketChangeListeners=new Array,this.AddUniform("numSteps","int",5),this.AddUniform("stepRotations","float[5]",null),this.AddUniform("stepSpeeds","float[5]",null),this.AddUniform("kernelWinds","float[4]",null),this.AddUniform("kernelPhases","float[4]",null),this.AddUniform("radial_radius","float",0),this.AddUniform("radial_power","float",0),this.AddUniform("radial_center","float",0),this.AddAttribute("trail"),this.Vertex_Definitions("\n      attribute float trail;\n      mat4 rotXY(float a) {\n            float c = cos(a);\n            float s = sin(a);\n            return mat4(\n                 c, s, 0, 0,\n                -s, c, 0, 0,\n                 0, 0, 1, 0,\n                 0, 0, 0, 1);\n        }\n        mat4 rotYZ(float a) {\n            float c = cos(a);\n            float s = sin(a);\n            return mat4(\n                1, 0, 0, 0,\n                0, c, s, 0,\n                0,-s, c, 0,\n                0, 0, 0, 1);\n        }\n        mat4 foldXY(float amount, float angle) {\n            mat4 angleMat = rotXY(angle);\n            return angleMat * rotYZ(amount) * transpose(angleMat);\n        }\n    "),this.Vertex_After_WorldPosComputed("\n        float r = 1.0 - (length(worldPos) - radial_center) / (radial_radius - radial_center);\n        r = clamp(r, 0.0, 1.0);\n        r = -0.5 * (cos(PI*r) - 1.0);\n        if (radial_power > 0.0) {\n          r = pow(r,radial_power);\n        } else {\n          r = 1.0-(pow(1.0-r,-radial_power));\n        }\n        mat4 rotation = mat4(1.0);\n        for (int i = 0; i < numSteps; i++) {\n          rotation = rotation * rotXY(stepRotations[i] + trail * stepSpeeds[i]);\n          rotation = rotation * foldXY(r * PI * kernelWinds[i], kernelPhases[i]);\n        }\n        rotation = rotation * rotXY(stepRotations[numSteps]);\n        worldPos = worldPos * rotation;\n        vNormalW = vec3(vec4(vNormalW, 1.0) * rotation);\n    "),this.onBindObservable.add((()=>{let e=this.getEffect();e.setInt("numSteps",4),e.setFloatArray("stepRotations",this.stepRotations),e.setFloatArray("stepSpeeds",this.stepSpeeds),e.setFloatArray("kernelWinds",this.kernelWinds),e.setFloatArray("kernelPhases",this.kernelPhases),e.setFloat("radial_radius",this.radius),e.setFloat("radial_power",this.power),e.setFloat("radial_center",this.center)})),e.registerBeforeRender((()=>{if(this.period>0){let i=e.getEngine().getDeltaTime()/1e3*Math.PI*2/this.period;this._time+=i;for(var t=0;t<=4;t++)this.stepRotations[t]+=this.stepSpeeds[t]*i}}))}parseBraKet(e){for(var t=0;t<4;t++)this.stepSpeeds[t]=0,this.stepPhases[t]=0,this.kernelWinds[t]=0,this.kernelPhases[t]=0;this.stepSpeeds[4]=0,this.stepPhases[4]=0;var i=0,s=0,r=0;for(t=0;t<e.length;t++)switch(e.charAt(t)){case"s":i%2==0?r+=s:r-=s,this.stepSpeeds[i]=s,s=0,this.kernelWinds[i]=1,i+=1;break;case"<":s+=1;break;case">":s-=1}for(var n of(i%2==0?r+=s:r-=s,this.stepSpeeds[i]=s,this.spin=r,this.time=this._time,this.braketChangeListeners))n()}addListener(e,t=!1){this.braketChangeListeners.push(e),t&&e()}set time(e){this._time=e;for(var t=0;t<=4;t++)this.stepRotations[t]=this.stepPhases[t]+this.stepSpeeds[t]*e}}t.BraketMaterial=r}},e=>(e.O(0,[216],(()=>(325,e(e.s=325)))),e.O())])));